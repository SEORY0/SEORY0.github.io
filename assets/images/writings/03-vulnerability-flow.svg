<svg viewBox="0 0 780 400" width="780" height="400" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <filter id="s3" x="-10%" y="-10%" width="120%" height="120%"><feDropShadow dx="0" dy="1" stdDeviation="2" flood-opacity="0.1"/></filter>
                <filter id="glow" x="-50%" y="-50%" width="200%" height="200%"><feGaussianBlur stdDeviation="2" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
            </defs>
            <rect x="15" y="15" width="170" height="370" fill="#eff6ff" stroke="#1e40af" stroke-width="2" rx="4"/>
            <text x="100" y="38" text-anchor="middle" fill="#1e40af" font-family="Arial" font-size="12" font-weight="bold">User Mode</text>
            <rect x="200" y="15" width="565" height="370" fill="#fef2f2" stroke="#991b1b" stroke-width="2" rx="4"/>
            <text x="482" y="38" text-anchor="middle" fill="#991b1b" font-family="Arial" font-size="12" font-weight="bold">Kernel Mode</text>
            <!-- Step 1 -->
            <rect x="30" y="60" width="140" height="38" fill="white" stroke="#1e40af" stroke-width="1.5" rx="4" filter="url(#s3)"/>
            <text x="100" y="83" text-anchor="middle" fill="#1e3a5f" font-family="Arial" font-size="11">Application</text>
            <circle cx="195" cy="65" r="10" fill="#1e40af"/><text x="195" y="69" text-anchor="middle" fill="white" font-family="Arial" font-size="10" font-weight="bold">1</text>
            <path d="M 170 79 L 225 79" fill="none" stroke="#1e40af" stroke-width="2" stroke-dasharray="55" stroke-dashoffset="55">
                <animate attributeName="stroke-dashoffset" from="55" to="0" dur="0.5s" repeatCount="indefinite"/>
            </path>
            <polygon points="220,74 230,79 220,84" fill="#1e40af" opacity="0">
                <animate attributeName="opacity" values="0;1" dur="0.5s" repeatCount="indefinite"/>
            </polygon>
            <!-- ks.sys -->
            <rect x="235" y="60" width="130" height="38" fill="white" stroke="#991b1b" stroke-width="1.5" rx="4" filter="url(#s3)"/>
            <text x="300" y="77" text-anchor="middle" fill="#7f1d1d" font-family="Arial" font-size="11">ks.sys</text>
            <text x="300" y="91" text-anchor="middle" fill="#64748b" font-family="Arial" font-size="9">Mode=1 âœ“</text>
            <!-- Step 2 -->
            <circle cx="320" cy="115" r="10" fill="#1e40af"/><text x="320" y="119" text-anchor="middle" fill="white" font-family="Arial" font-size="10" font-weight="bold">2</text>
            <path d="M 300 98 L 300 130" fill="none" stroke="#1e40af" stroke-width="2" stroke-dasharray="32" stroke-dashoffset="32">
                <animate attributeName="stroke-dashoffset" from="32" to="0" dur="0.3s" begin="0.6s" repeatCount="indefinite"/>
            </path>
            <polygon points="295,125 300,135 305,125" fill="#1e40af" opacity="0">
                <animate attributeName="opacity" values="0;1" dur="0.3s" begin="0.6s" repeatCount="indefinite"/>
            </polygon>
            <!-- UnserializePropertySet -->
            <rect x="220" y="140" width="160" height="45" fill="#fef3c7" stroke="#d97706" stroke-width="2" rx="4" filter="url(#s3)"/>
            <text x="300" y="160" text-anchor="middle" fill="#92400e" font-family="Arial" font-size="10" font-weight="500">UnserializePropertySet</text>
            <text x="300" y="175" text-anchor="middle" fill="#b45309" font-family="Arial" font-size="9">âš ï¸ ì·¨ì•½ í•¨ìˆ˜</text>
            <!-- Step 3: IOCTL ì¬í˜¸ì¶œ -->
            <circle cx="420" cy="148" r="10" fill="#dc2626"/><text x="420" y="152" text-anchor="middle" fill="white" font-family="Arial" font-size="10" font-weight="bold">3</text>
            <path d="M 380 162 L 460 162" fill="none" stroke="#dc2626" stroke-width="2.5" stroke-dasharray="80" stroke-dashoffset="80">
                <animate attributeName="stroke-dashoffset" from="80" to="0" dur="0.6s" begin="1s" repeatCount="indefinite"/>
            </path>
            <polygon points="455,157 465,162 455,167" fill="#dc2626" opacity="0">
                <animate attributeName="opacity" values="0;1" dur="0.6s" begin="1s" repeatCount="indefinite"/>
            </polygon>
            <!-- KsSynchronousIoControlDevice -->
            <rect x="470" y="135" width="280" height="55" fill="#fef2f2" stroke="#dc2626" stroke-width="2" rx="4" filter="url(#glow)"/>
            <text x="610" y="155" text-anchor="middle" fill="#991b1b" font-family="Arial" font-size="10">KsSynchronousIoControlDevice(</text>
            <text x="610" y="172" text-anchor="middle" fill="#dc2626" font-family="Consolas" font-size="11" font-weight="bold">RequestorMode = 0</text>
            <text x="610" y="185" text-anchor="middle" fill="#991b1b" font-family="Arial" font-size="10">)</text>
            <!-- Step 4 -->
            <circle cx="630" cy="210" r="10" fill="#dc2626"/><text x="630" y="214" text-anchor="middle" fill="white" font-family="Arial" font-size="10" font-weight="bold">4</text>
            <text x="665" y="215" fill="#dc2626" font-family="Arial" font-size="9">ìƒˆ IRP</text>
            <path d="M 610 190 L 610 230" fill="none" stroke="#dc2626" stroke-width="2" stroke-dasharray="40" stroke-dashoffset="40">
                <animate attributeName="stroke-dashoffset" from="40" to="0" dur="0.4s" begin="1.7s" repeatCount="indefinite"/>
            </path>
            <polygon points="605,225 610,235 615,225" fill="#dc2626" opacity="0">
                <animate attributeName="opacity" values="0;1" dur="0.4s" begin="1.7s" repeatCount="indefinite"/>
            </polygon>
            <!-- ksthunk.sys -->
            <rect x="470" y="240" width="280" height="50" fill="#7f1d1d" stroke="#dc2626" stroke-width="2" rx="4" filter="url(#s3)"/>
            <text x="610" y="262" text-anchor="middle" fill="white" font-family="Arial" font-size="11" font-weight="500">ksthunk.sys</text>
            <text x="610" y="280" text-anchor="middle" fill="#fca5a5" font-family="Arial" font-size="10">Mode=0 â†’ ê²€ì¦ ìƒëµ!</text>
            <!-- Step 5 -->
            <circle cx="630" cy="310" r="10" fill="#dc2626"/><text x="630" y="314" text-anchor="middle" fill="white" font-family="Arial" font-size="10" font-weight="bold">5</text>
            <path d="M 610 290 L 610 330" fill="none" stroke="#dc2626" stroke-width="2.5" stroke-dasharray="40" stroke-dashoffset="40">
                <animate attributeName="stroke-dashoffset" from="40" to="0" dur="0.4s" begin="2.2s" repeatCount="indefinite"/>
            </path>
            <polygon points="605,325 610,335 615,325" fill="#dc2626" opacity="0">
                <animate attributeName="opacity" values="0;1" dur="0.4s" begin="2.2s" repeatCount="indefinite"/>
            </polygon>
            <!-- Arbitrary Call -->
            <rect x="470" y="340" width="280" height="32" fill="#dc2626" stroke="#7f1d1d" stroke-width="2" rx="4">
                <animate attributeName="opacity" values="1;0.7;1" dur="0.5s" begin="2.7s" repeatCount="indefinite"/>
            </rect>
            <text x="610" y="361" text-anchor="middle" fill="white" font-family="Arial" font-size="11" font-weight="bold">ğŸ’€ ì„ì˜ í•¨ìˆ˜ í˜¸ì¶œ (jmp rax)</text>
            <!-- ì•…ì˜ì  ë°ì´í„° -->
            <rect x="30" y="140" width="140" height="70" fill="white" stroke="#dc2626" stroke-width="1.5" stroke-dasharray="4,2" rx="4"/>
            <text x="100" y="165" text-anchor="middle" fill="#dc2626" font-family="Arial" font-size="10" font-weight="500">ì•…ì˜ì  ë°ì´í„°</text>
            <text x="100" y="182" text-anchor="middle" fill="#64748b" font-family="Arial" font-size="9">ptr_ArbitraryFunCall</text>
            <text x="100" y="198" text-anchor="middle" fill="#dc2626" font-family="Arial" font-size="9">â¬†ï¸ ê·¸ëŒ€ë¡œ ì „ë‹¬</text>
            <!-- í•µì‹¬ ë¬¸ì œ -->
            <rect x="220" y="320" width="200" height="52" fill="#fef2f2" stroke="#fca5a5" rx="4"/>
            <text x="320" y="342" text-anchor="middle" fill="#991b1b" font-family="Arial" font-size="10" font-weight="500">ğŸ”‘ í•µì‹¬ ë¬¸ì œ</text>
            <text x="320" y="360" text-anchor="middle" fill="#7f1d1d" font-family="Arial" font-size="9">ì‚¬ìš©ì ë°ì´í„°ê°€ KernelMode IRPì— í¬í•¨</text>
        </svg>